namespace Vulns.Core;

public class Vulnerability : Entity
{
    public override string Id { get; set; } = string.Empty;
    public override DateTime CreatedAt { get; set; }
    public override DateTime? ModifiedAt { get; set; }
    public String Description { get; set; } = null!;

    public String IssuerEmail { get; set; } = null!;
    public string? IssuerId { get; set; }
    public Issuer? Issuer { get; set; }
    public VulnerabilitySeverity? Severity { get; set; }
    public ICollection<Product> VulnerableProducts { get; set; } = new List<Product>();
    public ICollection<Weakness> Weaknesses { get; set; } = new List<Weakness>();
    public ICollection<VulnerabilityReference>? References { get; set; }

    public bool HasExploit { get; set; }
    public bool HasFix { get; set; }

    public VulnerabilityImpact ConfidentialityImpact { get; set; } = VulnerabilityImpact.Unspecified;
    public VulnerabilityImpact IntegrityImpact { get; set; } = VulnerabilityImpact.Unspecified;
    public VulnerabilityImpact AvailabilityImpact { get; set; } = VulnerabilityImpact.Unspecified;
    public VulnerabilityAttackVector AttackVector { get; set; } = VulnerabilityAttackVector.Unspecified;
    public VulnerabilityAttackComplexity AttackComplexity { get; set; } = VulnerabilityAttackComplexity.Unspecified;
    public VulnerabilityRequiredAuthentication RequiredAuthentication { get; set; } = VulnerabilityRequiredAuthentication.Unspecified;
}