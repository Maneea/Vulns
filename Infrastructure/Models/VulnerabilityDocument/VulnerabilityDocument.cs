using Nest;
namespace Vulns.Infrastructure;

[ElasticsearchType(RelationName = "vulnerability")]
public class VulnerabilityDocument
{
    public DateTime CreatedAt { get; set; }
    public DateTime? ModifiedAt { get; set; }
    [Keyword]
    public String Id { get; set; } = null!;
    [Text]
    public String Description { get; set; } = null!;
    [Object]
    public VulnerabilityIssuerDocument? Issuer { get; set; }
    [Object]
    public VulnerabilitySeverityDocument? Severity { get; set; }
    [Keyword]
    public ICollection<String>? VulnerableProductsNames { get; set; }
    [Keyword]
    public ICollection<String>? VulnerableVendorNames { get; set; }
    [Keyword]
    public ICollection<String>? Weaknesses { get; set; }
    [Keyword]
    public ICollection<String>? WeaknessesNames { get; set; }
    [Keyword]
    public ICollection<String>? WeaknessesPlatforms { get; set; }
    [Keyword]
    public ICollection<String>? WeaknessesAffectedResources { get; set; }
    [Nested]
    public ICollection<VulnerabilityProductDocument>? VulnerableProducts { get; set; }
    [Nested]
    public ICollection<VulnerabilityReferenceDocument>? References { get; set; }
    [Boolean]
    public bool HasExploit { get; set; }
    [Boolean]
    public bool HasFix { get; set; }
    [Keyword]
    public String? ConfidentialityImpact { get; set; }
    [Keyword]
    public String? IntegrityImpact { get; set; }
    [Keyword]
    public String? AvailabilityImpact { get; set; }
    [Keyword]
    public String? AttackVector { get; set; }
    [Keyword]
    public String? AttackComplexity { get; set; }
    [Keyword]
    public String? RequiredAuthentication { get; set; }
}

