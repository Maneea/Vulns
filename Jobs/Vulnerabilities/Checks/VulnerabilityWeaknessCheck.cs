using Vulns.Core;
using Vulns.Jobs.Base;

namespace Vulns.Jobs.Vulnerabilities;
public class VulnerabilityWeaknessCheck : IJobCheck<Vulnerability>
{
    private readonly IRepository<Weakness> _repo;
    public VulnerabilityWeaknessCheck(IRepository<Weakness> repo) => _repo = repo;
    public bool IsCheckPassed() => IsCheckPassedAsync(default).Result;
    public async Task<bool> IsCheckPassedAsync(CancellationToken token) => !await _repo.IsEmptyAsync(token);
}