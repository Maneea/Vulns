using Vulns.Core;
using Vulns.Jobs.Base;

namespace Vulns.Jobs.Vulnerabilities;
public class VulnerabilityIssuerCheck : IJobCheck<Vulnerability>
{
    private readonly IRepository<Issuer> _repo;
    public VulnerabilityIssuerCheck(IRepository<Issuer> repo) => _repo = repo;
    public bool IsCheckPassed() => IsCheckPassedAsync(default).Result;
    public async Task<bool> IsCheckPassedAsync(CancellationToken token) => !await _repo.IsEmptyAsync(token);
}