using System.ComponentModel.DataAnnotations;

using Microsoft.AspNetCore.Mvc.ModelBinding;

namespace Vulns.Web;
public class VulnerabilitySearchFilters
{
    public DateTime? PublishedFrom { get; set; }
    public DateTime? PublishedTo { get; set; }
    public DateTime? ModifiedFrom { get; set; }
    public DateTime? ModifiedTo { get; set; }
    [Range(0.0, 10.0)]
    public float? SeverityFrom { get; set; }
    [Range(0.0, 10.0)]
    public float? SeverityTo { get; set; }
    public Boolean? HasExploit { get; set; }
    public Boolean? HasFix { get; set; }
    public Boolean? IsUserInteractionRequired { get; set; }
    public ICollection<String>? Issuers { get; set; }
    public ICollection<String>? ConfidentialityImpacts { get; set; }
    public ICollection<String>? IntegrityImpacts { get; set; }
    public ICollection<String>? AvailabilityImpacts { get; set; }
    public ICollection<String>? AttackVectors { get; set; }
    public ICollection<String>? AttackComplexities { get; set; }
    public ICollection<String>? Weaknesses { get; set; }
    public ICollection<String>? WeaknessPlatforms { get; set; }
    public ICollection<ProductSearchFilters>? VulnerableProducts { get; set; }

    public String? Phrase { get; set; }

    [Range(1, int.MaxValue)]
    public int Page { get; set; } = 1;

    [Range(1, 100)]
    public int Size { get; set; } = 10;

    [BindNever]
    public int Offset { get => (Page - 1) * Size; }
}